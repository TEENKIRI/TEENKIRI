<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>내 정보 수정</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>
</head>
<body>
<div class="container mt-5">
    <h3>내 정보 수정</h3>
    <form id="updateForm">
        <input type="hidden" id="userId" name="id" th:value="${user.id}">
        <div class="mb-3">
            <label for="nickname" class="form-label">닉네임</label>
            <input type="text" class="form-control" id="nickname" name="nickname" th:value="${user.nickname}" required>
        </div>
        <div class="mb-3">
            <label for="password" class="form-label">비밀번호</label>
            <input type="password" class="form-control" id="password" name="password" required>
        </div>
        <div class="mb-3">
            <label for="address" class="form-label">주소</label>
            <input type="text" class="form-control" id="address" name="address" th:value="${user.address}" required>
        </div>
        <div class="mb-3">
            <label for="name" class="form-label">이름</label>
            <input type="text" class="form-control" id="name" name="name" th:value="${user.username}" disabled>
        </div>
        <div class="mb-3">
            <label for="email" class="form-label">이메일</label>
            <input type="email" class="form-control" id="email" name="email" th:value="${user.email}" disabled>
        </div>
        <div class="mb-3">
            <label for="phoneNumber" class="form-label">핸드폰 번호</label>
            <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" th:value="${user.phone}" disabled>
        </div>
        <button type="button" class="btn btn-primary" onclick="updateUser()">수정하기</button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function updateUser() {
        const updateData = {
            id: $('#userId').val(),
            nickname: $('#nickname').val(),
            password: $('#password').val(),
            address: $('#address').val()
        };

        $.ajax({
            url: '/mypage/update/' + updateData.id,
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify(updateData),
            success: function(response) {
                alert('정보가 수정되었습니다.');
            },
            error: function(error) {
                alert('정보 수정에 실패했습니다.');
            }
        });
    }

    $(document).ready(function() {
        // 유저 정보를 불러와서 폼에 채워넣기 (로그인 기능이 추가되면 이 부분을 구현)
    });
</script>
</body>
</html>
